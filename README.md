# Что это:

**K-Switcher** — утилита для переключения раскладки набранного текста, повторяющая некоторые функции известного Punto Switcher-а.

## Что умеет:

K-Switcher умеет переключать раскладку (и перекодировать текст) с русской на английскую и наоборот. Другие раскладки не поддерживаются. Перекодировка происходит при нажатии горячих клавиш:

**Shift+Break** — перекодировать выделенный фрагмент текста.

**Break** — перекодировать слово слева от курсора.

## Как использовать:

Программа состоит из одного исполняемого файла, инсталляция не требуется. После запуска программа открывает консоль, в которой показывает перекодируемые фрагменты текста. Консоль через несколько секунд сворачивается в трей, откуда её можно вызвать, кликнув по иконке клавиатуры.

## Как это работает:

При работе программа эмулирует нажатия клавиш для работы с буфером обмена (клипбоардом) следующим образом:

**Shift+Break** — сохраняется состояние клипбоарда, эмулируется нажатие `Ctrl+C` (скопировать выделенный текст), текст в буфере обмена перекодируется, эмулируется нажатие `Ctrl+V` (вставить выделенный текст), восстанавливается состояние клипбоарда.

**Break** — сохраняется состояние клипбоарда, эмулируется нажатие `Ctrl+Shift+←` (выделить слово слева от курсора), эмулируется нажатие `Ctrl+C` (скопировать выделенный текст), текст в буфере обмена перекодируется, эмулируется нажатие `Ctrl+V` (вставить выделенный текст), восстанавливается состояние клипбоарда.

Таким образом, перекодировка работает только в программах, использующих сочетания клавиш `Ctrl+C` и `Ctrl+V` для работы с клипбоардом. Таких программ большинство, но могут встретиться и исключения, в которых K-Switcher будет работать некорректно.

При перекодировке K-Switcher сохраняет и восстанавливает состояние клипбоарда, однако сохраняется только текстовое содержимое. Если в клипбоарде была картинка, ссылка на файл, фрагмент документа с форматированием и т. п., то после перекодировки это содержимое будет потеряно.

